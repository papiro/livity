var livity=livity||{};livity.ajax=function(){function t(t,e){var i=new XMLHttpRequest;return i.open(t,e),i}var e={};return e.GET=function(e,i,n,r){var a=t("GET",e);a.onreadystatechange=function(){if(4===a.readyState){switch(Math.floor(a.status/100)){case 4:case 5:n&&n(a);break;default:i&&i(a)}r&&r(a)}},a.send()},e.POST=function(e,i,n,r,a){t("POST",e),req.send(i)},e}();var livity=livity||{};livity.util=function(){var t={each:function(t,e){for(var i in t)t.hasOwnProperty(i)&&e(i,t[i],t)},extend:function(){return Array.prototype.slice.call(arguments,1).reduce(function(e,i){return t.each(i,function(t,i){e[t]=i}),e},arguments[0])}};return t}();var livity=livity||{};livity.dom=function(){var t=livity.util,e=function(t,e){var e=e||document,n=window;if(t instanceof i)return t;if(t instanceof HTMLElement||t instanceof Document)n=t;else if("string"==typeof t){var r=t;n=r.indexOf("#")?e.querySelector(t):e.getElementById(r.slice(1))}else t&&t.length&&(n=t[0]);return new i(n,r)};e.create=function(t){if("<"===t[0]){var e=document.createElement("div");return e.innerHTML=t,1===e.childElementCount?new i(e.firstChild):e.children}return new i(document.createElement(t))};var i=function(t,e){switch(this.native=t,t){case window:this.selector="window";break;case document:this.selector="document";break;default:this.selector=e}},n=e.safe=function(t){return function(){try{return t.apply(this,arguments)}catch(t){console.trace(t)}}};return e.htmlElement=i,i.prototype={find:n(function(t){return e(t,this.native)}),at:n(function(t,e){if(!t){for(var i=0,n=this.native,r={};i<n.attributes.length;i++){var a=attributes[i];r[a.name]=a.value}return r}return void 0===e?this.native.getAttribute(t):(this.native.setAttribute(t,e),this)}),text:n(function(t){return t?(this.native.textContent=t,this):this.native.textContent}),class:n(function(t){return t?(this.native.className=t,this):this.native.className}),style:n(function(e,i){if("object"==typeof e)return t.each(e,function(t,e){this.style(t,e)}.bind(this)),this;if(void 0!==i&&null!==i)return"number"!=typeof i||~["opacity","z-index"].indexOf(e)||(i+="px"),this.native.style[e]=i,this;var n=window.getComputedStyle(this.native);return e?n[e]:n}),classtoggle:n(function(t){return RegExp(t).test(this.native.className)?this.native.className=this.native.className.replace(RegExp(" "+t+"|"+t+" |"+t,"g"),""):this.native.className+=" "+t,this}),offset:n(function(){return{top:this.native.offsetTop,left:this.native.offsetLeft,right:this.native.offsetRight}}),height:n(function(){return this.native.offsetHeight}),innerHeight:n(function(){return this.native.clientHeight}),outerHeight:n(function(){return this.native.scrollHeight}),width:n(function(){return this.native.offsetWidth}),innerWidth:n(function(){return"window"===this.selector?this.native.innerWidth:this.native.clientWidth}),outerWidth:n(function(){return this.native.scrollWidth}),show:n(function(t){var e=this.native.style;return e.display=t?"block":"flex",e.visibility="visible",this}),hide:n(function(t){return this.native.style[t?"visibility":"display"]=t?"hidden":"none",this}),toggle:n(function(t){return this[t?"show":"hide"]()}),append:n(function(t){return t=t instanceof i?t.native:t,this.native.appendChild(t),this}),prepend:n(function(t){return t=t instanceof i?t.native:t,this.native.insertBefore(t,this.native.firstChild),this}),appendTo:n(function(t){return e(t).append(this),this}),prependTo:n(function(t){return e(t).prepend(this),this}),inner:n(function(t){return this.clear(),t=t instanceof i?t.native:t,"string"==typeof t?this.native.innerHTML=t:this.append(t),this}),clear:n(function(){for(var t;t=this.native.firstChild;)this.native.removeChild(t);return this}),remove:n(function(t){return t=("string"==typeof t?e(t).native:t)||this.native,t.parentNode&&t.parentNode.removeChild(t),t}),replaceWith:n(function(t){return this.native.parentNode.replaceChild(t.native||t,this.native),e(t)}),clone:n(function(t){return e(this.native.cloneNode(t))}),next:n(function(){return e(this.native.nextElementSibling)}),previous:n(function(){return e(this.native.previousElementSibling)}),isImg:n(function(){return!(!this.native||"IMG"!==this.native.nodeName)})},e}();var livity=livity||{},dom=livity.dom,util=livity.util;util.extend(dom.htmlElement.prototype,{transition:dom.safe(function(){for(var t=[],e="";arguments.length>1;)t.push(Array.prototype.splice.call(arguments,0,3));return t=t.map(function(t){var i=t,n=i[0],r=i[1],a=i[2],o=n.split(" ")[0];return e+=(e&&", ")+n,this.style(o,r),[o,a]},this),this.style("transition",e).listenOnce("transitionend",arguments[0]||function(){}),t.forEach(function(t){var e=this;window.setTimeout(function(){e.style(t[0],t[1])},0)},this),this})}),livity.css=function(){return{buildStylesheet:function(t){var e=document.createElement("style");document.head.appendChild(e);var i=e.sheet;t.reverse().forEach(function(t){i.insertRule(t,0)})}}}(),window.livity=livity||{},livity.generate=function(){var t=function(t){var e=[];return util.each(config,function(t,i){e.push(dom.create(t).style(i))}),1===e.length?e[0]:e};return t};var livity=livity||{};livity.event=function(){function t(t,e,i,n,r){this.elem=t,this.type=e,this.handler=i,this._wrappedHandler=n,this.target=r}var e=livity.dom,i=livity.util,n=[],r=[];return i.extend(t.prototype,{register:function(){this.elem.native.addEventListener(this.type,this._wrappedHandler),this.index=n.length,n.push(this.handler),r.push(this),r.length%10===0&&console.log("Just reached %s event listeners",r.length)},deregister:function(){t.handlerIndices(this.handler).filter(function(t){return r[t].type===this.type&&r[t].elem.native===this.elem.native},this).forEach(function(t){n.splice(t,1),listener=r.splice(t,1)[0],this.elem.native.removeEventListener(listener.type,listener._wrappedHandler)},this)}}),i.extend(t,{register:function(t){t.register()},deregister:function(t){t.deregister()},deregisterDOMNode:function(t){r.filter(function(e){return e.elem.native===t.native}).forEach(function(t){t.deregister()})},handlerIndices:function(t){for(var e=0,i=[];~(e=n.indexOf(t,e+1));)i.push(e);return i}}),i.extend(e.htmlElement.prototype,{listen:e.safe(function(i,n,r){function a(t){if(!c)return n.bind(e(this))(t);if(t.target!==t.currentTarget){var i=t.target,r=Array.prototype.slice.call(t.currentTarget.querySelectorAll(c));do{if(~r.indexOf(i))return n.bind(e(i))(t,e(t.currentTarget));i=i.parentElement}while(i!==t.currentTarget)}}function o(t){a.call(this,t),e(this).unlisten(l,n)}if(!this.native)return this;var r=r||{},s=i.split(" "),l=s.shift();if(/ on /.test(i))var c=s.pop();return t.register(new t(this,l,n,r.once?o:a,c)),this}),listenOnce:e.safe(function(){Array.prototype.push.call(arguments,{once:!0}),this.listen.apply(this,arguments)}),unlisten:e.safe(function(e,i){t.deregister(new t(this,e,i))}),deregisterEvents:e.safe(function(){return t.deregisterDOMNode(this),this}),trigger:e.safe(function(t,e){var i=function(){var i;try{i=new CustomEvent(t,e)}catch(n){i=document.createEvent("CustomEvent"),i.initEvent(t,!0,!0,e)}return i};return this.native.dispatchEvent(i()),this})}),e.DOMContentLoaded=function(t){return"complete"===document.readyState?t():void e(document).listen("DOMContentLoaded",function(){t()},{stack:!0})},{_listeners:r,getListeners:function(t){var e;switch(typeof t){case"string":e="type";break;case"object":e="elem";break;case"function":e="handler";break;default:throw new ReferenceError("Faulty criteria passed to livity.event.getListeners")}return r.filter(function(i){return("elem"===e?i[e].native:i[e])===("elem"===e?t.native:t)})}}}();var livity=livity||{};livity.router=function(){var t=livity.dom,e=livity.ajax,i=function(n){var r=n.routes||{};t().listen("hashchange",function(){var a=window.location.hash,o=r.hasOwnProperty(a)?r[a]:a;o=o.slice("/"===o[1]?2:1),e.GET(n.markupDir+"/"+o+".html",function(e){t(n.view).inner(e.response),t(document).trigger("view."+o)}),i.initialized=!0}),window.location.hash&&!i.initialized&&t().trigger("hashchange")};return i}(),livity.css.buildStylesheet([".livity-overlay {    display: none;    position: fixed;    top: 7%;    right: 0;    bottom: 7%;    left: 0;  }",".livity-overlay-x {    position: fixed;    z-index: 1;    color: hsla(0, 0%, 75%, 0.65);    text-shadow: 0 0 0.2em black;    cursor: pointer;    top: 12%;    right: 5%;    font-size: 60px;  }",".livity-overlay-x:hover {    color: hsla(81, 44%, 75%, 1);  }"]);var livity=livity||{};livity.WebUIComponents=livity.WebUIComponents||[],livity.css.buildStylesheet(["[data-livity-gallery] {    display: flex;    flex-wrap: wrap;    text-align: center;    justify-content: center;  }","[data-livity-gallery] h2 {    width: 100%;  }","[data-livity-gallery] img {    cursor: pointer;    margin: 0.7em;  }","[data-livity-gallery-overlay] img {    position: relative;    margin: auto;    width: auto;    max-width: 100%;    max-height: 100%;    box-shadow: 0 0 7em 5em hsla(100, 100%, 0%, 0.8);  }",".livity-overlay-right,  .livity-overlay-left {    position: fixed;    color: hsla(0, 0%, 75%, 1);    cursor: pointer;  }",".livity-overlay-right,  .livity-overlay-left {    z-index: 1;    top: 45%;    font-size: 4em;  }",".livity-overlay-right {    right: 2%;    text-shadow: -0.05em 0 0.05em white;  }",".livity-overlay-left {    left: 2%;    text-shadow: 0.05em 0 0.05em white;  }",".livity-overlay-right:hover,  .livity-overlay-left:hover {    color: hsla(81, 44%, 75%, 1);  }"]),livity.dom.DOMContentLoaded(function(){livity.dom.create("div").at("data-livity-gallery-overlay","").at("id","overlay").class("livity-overlay").append(livity.dom.create("span").at("data-x","").class("livity-overlay-x").inner("&#x2716;")).append(livity.dom.create("span").at("data-right","").class("livity-overlay-right").inner("&#xbb;")).append(livity.dom.create("span").at("data-left","").class("livity-overlay-left").inner("&#xab;")).appendTo("body")}),livity.WebUIComponents.push(function(){var t=window.livity.dom,e=function(){t("[data-livity-gallery]").listen("click on img",function(e){function i(e){var i=e.next,l=i?1:-1;if(s+=l,o[s].img){var c=this.find("img"),h=t(o[s].img),u=t(window).innerWidth(),v=function(){a(h),this.at("style","").remove(),this.unlisten("transitionend",v)};if(r(!1),c.transition("margin-"+(i?"right":"left")+" 1s ease-out",(u-c.width())/2,-u,"opacity 1s ease-out",1,0).listen("transitionend",v),h[i?"appendTo":"prependTo"]("[data-livity-gallery-overlay]").transition("margin-"+(i?"right":"left")+" 1s ease-out",-u,(u-h.width())/2,"opacity 1s ease-out",0,1),!o[s+l]){var d=o[s].thumb[s?"next":"previous"]();o[s?"push":"unshift"]({thumb:d,img:n(d)})}}else s-=l;s||(s=1)}function n(t){var e=new Image,i=t.transformSrc();return i&&(e.src=i),e.src&&e}function r(e){t("[data-x]").toggle(e),t("[data-right]").toggle(e),t("[data-left]").toggle(e)}function a(e){var i=t("[data-x]");r(!0),i.style({top:t(e).offset().top+i.height()+"px",right:t(e).offset().left+i.width()+"px"})}t.htmlElement.prototype.transformSrc=function(){return this.isImg()&&(this.at("data-target")||this.at("src").replace("thumbs/",""))};var o=[{thumb:this.previous()},{thumb:this},{thumb:this.next()}],s=1,l=t("[data-x]");o[1].img=n(o[1].thumb),t(o[1].img).listenOnce("load",function(){for(var t=0,e=[0,2];2>t;t++)o[e[t]].img=n(o[e[t]].thumb);a(this),l.show()}),l.hide(!0);var c=t("body").style("overflow");t("body").style("overflow","hidden"),t("[data-livity-gallery-overlay]").append(o[1].img).listen("click on [data-x]",function(e,i){t("body").style("overflow",c),i.hide().deregisterEvents().find("img").remove()},{cache:!0}).listen("click on [data-right]",function(t,e){i.call(e,{next:!0})}).listen("click on [data-left]",function(t,e){i.call(e,{prev:!0})}).show()})};return e}()),livity.dom.DOMContentLoaded(function(){var t=livity.util,e=livity.dom;e("[data-dropup-options]").listen("click",function(i){var n={"<div>":{position:"absolute",left:i.target.offsetLeft,top:i.target.offsetTop,width:"auto","background-color":"black",border:"0.2em solid yellow"}},r=JSON.parse(this.at("data-dropup-options").trim()),a=e.generate(n);t.each(r,function(t,i){a.append(e.create("<a href="+i+">").text(t))}),a.appendTo("body"),e(window).listen("click",function(t){a.remove()})})});
//# sourceMappingURL=dist/livity.min.js.map