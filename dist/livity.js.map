{"version":3,"sources":["livity.js"],"names":["_evtData","Map","noop","numberOfListeners","Listener","elem","type","handler","_wrappedHandler","target","Object","assign","addEventListener","has","set","_wrappedHandlers","handlers","obj","get","push","console","debug","data","dataForType","handlerIndex","indexOf","splice","removeEventListener","length","keys","delete","listener","register","deregister","_listeners","filter","forEach","c","ReferenceError","L","query","root","document","queryMethod","match","Array","Node","Window","TypeError","test","slice","collection","HTMLCollection","from","map","reduce","prev","l","name","value","attrMap","i","attributes","attribute","undefined","getAttribute","setAttribute","text","textContent","prop","val","util","each","style","bind","window","getComputedStyle","classes","className","cnames","splitCnames","split","matcher","cname","replace","RegExp","removeClass","addClass","top","offsetTop","left","offsetLeft","right","offsetRight","offsetHeight","clientHeight","scrollHeight","offsetWidth","selector","innerWidth","clientWidth","scrollWidth","flex","elemStyle","display","visibility","noreflow","show","child","appendChild","insertBefore","firstChild","append","prepend","html","empty","innerHTML","removeChild","eType","options","_on","wrappedHandler","evt","iteration","targets","currentTarget","querySelectorAll","parentElement","wrappedHandlerOnce","call","off","once","on","apply","arguments","deregisterDOMNode","eventName","detail","nativeEvents","customEvent","CustomEvent","e","createEvent","initCustomEvent","dispatchEvent","getListeners","args","_openAndReturnReq","method","url","req","XMLHttpRequest","open","callback","key","hasOwnProperty","DOMContentLoaded","_callback","readyState","router","config","view","templateDirectory","callbacks","initialized","hash","location","route","ajax","then","response","trigger","catch","err","Promise","resolve","reject","onreadystatechange","Math","floor","status","send","create","newElement","temp","createElement","childElementCount","children","init","head","body","search","write","stack","error","params","curr","arr","encodeURIComponent","prototype","forIn","DEBUG","log"],"mappings":"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","file":"livity.js","sourcesContent":["'use strict'\n\n;(() => {\n\n  /**\n   * Decided to go with a memory-unsafe Map, rather than a memory-safe WeakMap for one reason:\n   * Allows the LivityAPI to provide methods to return detailed data for all event listeners\n   *  currently subscribed through the framework.  \n   *  With WeakMaps, I would need to keep a separate reference of every key (DOM node) in \n   *  order to loop through and read each listener from the WeakMap.  \n   *  If a listener was registered through the framework, deregister it through the framework.  \n  **/\n  const _evtData = new Map()\n  const noop = () => {}\n\n  let numberOfListeners = 0\n\n  class Listener {\n    constructor (elem, type, handler, _wrappedHandler, target) {\n      Object.assign(this, { elem, type, handler, _wrappedHandler, target })\n    }\n    \n    register () {\n      const { elem, type, handler, _wrappedHandler } = this\n      \n      elem.addEventListener(type, _wrappedHandler)\n      \n      // initialize new listener data\n      !_evtData.has(elem) && _evtData.set(elem, { \n        [type]: {\n          _wrappedHandlers: [],\n          handlers: []\n        }\n      })\n\n      const obj = _evtData.get(elem)[type]\n      // store the listener data\n      obj._wrappedHandlers.push(_wrappedHandler)\n      obj.handlers.push(handler)\n\n      if (++numberOfListeners % 10 === 0) {\n        console.debug(`Just reached ${numberOfListeners} event listeners`)\n      }\n    }\n\n    // Note: Does not consider delegated targets when deregistering\n    deregister () {\n      const { elem, type, handler } = this\n\n      let data = _evtData.get(elem)\n      let dataForType = data[type]\n      const handlerIndex = dataForType.handlers.indexOf(handler)\n      const _wrappedHandler = dataForType._wrappedHandlers.splice(handlerIndex, 1)[0]\n\n      elem.removeEventListener(type, _wrappedHandler)\n\n      // clean up\n      dataForType.handlers.splice(handlerIndex, 1)[0]\n      if (!dataForType.handlers.length) {\n        data[type] = null\n        delete data[type]\n        if (!Object.keys(data).length) {\n          data = null\n          _evtData.delete(elem)\n        }\n      }\n\n      numberOfListeners--\n    }\n    \n    /*convenience methods*/\n    static register (listener) {\n      listener.register()\n    }\n    \n    static deregister (listener) {\n      listener.deregister()\n    }\n    /*********************/\n\n    static deregisterDOMNode (elem) {\n      _listeners\n        .filter( listener => listener.elem === elem )\n        .forEach( listener => {\n          listener.deregister()\n        })\n    } \n\n    static getListeners (c) {\n      var filter\n      switch (typeof c) {\n        case 'undefined':\n          return [..._evtData]\n          break\n        case 'string':\n          filter = 'type'\n          break\n        case 'object':\n          filter = 'elem'\n          break\n        case 'function':\n          filter = 'handler'\n          break\n        default:\n          throw new ReferenceError('Faulty criteria passed to Listener.getListeners')\n      }        \n    }\n  }\n\n  class L extends Array {\n    constructor (query, root = document) {\n      super()\n      let queryMethod = '', match\n      console.debug(`query:::\"${query}\"`)\n      // special types\n      // simply wrap if already an array\n      if (query instanceof Array) {\n        return Object.assign(this, query)\n      } else if (query instanceof Node || query instanceof Window) {\n        match = query \n      } else if (typeof query !== 'string') {\n        throw new TypeError(`L needs a string but was passed ${query}, which is a ${typeof query}`)\n      } else if ((/(\\w[ \\.#])|(^\\[)/).test(query)) {\n        queryMethod = 'querySelectorAll'\n      } else {\n        switch (query[0]) {\n          case '#':\n            queryMethod = 'getElementById'\n            query = query.slice(1)\n            root = document\n            break\n          case '.':\n            queryMethod = 'getElementsByClassName'\n            query = query.slice(1)\n            break\n          default:\n            queryMethod = 'getElementsByTagName'\n        }\n      }\n      match = match || root[queryMethod](query)\n      const collection = match ? ( match.length || match instanceof HTMLCollection ) ? Array.from(match) : [match] : []\n      console.debug(`returned:::${collection}`)\n      Object.assign(this, collection)\n    }\n\n    // Alas, native Array map is busted on the L subclass :(\n    // So convert into a true Array, run map, and actually return a new instance\n    map (...args) {\n      return new L(Array.from(this).map(...args))\n    }\n\n    /* executes a new element selection using \"this\" as the root */\n    find (query) {\n      return this.reduce( (prev, elem) => {\n        return l(query, elem)\n      }, [])\n    }\n\n    /* get/set attribute */\n    attr (name, value) {\n      if (!name) {\n        let attrMap = {};\n        for (let i=0; i<this.attributes.length; i++) {\n          const attribute = this.attributes[i]\n          attrMap[attribute.name] = attribute.value\n        }\n        return attrMap\n      }\n\n      if (value === undefined) {\n        return this[0].getAttribute(name)\n      }\n\n      this.forEach( elem => {\n        elem.setAttribute(name, value)\n      })\n      return this        \n    }\n\n    /* get/set text */\n    text (text) {\n      if (text) {\n        this.forEach( elem => {\n          elem.textContent = text\n        })\n      }\n      return ( text ? this : this.textContent )\n    }\n\n    /* get applied styles / set inline styles */\n    css (prop, val) {\n      if (typeof prop === 'object') {\n        util.each(prop, function (prop, val) {\n          this.style(prop, val)\n        }.bind(this))\n        return this\n      } else if (val !== undefined && val !== null) {\n        if (typeof val === 'number' && !~['opacity', 'z-index'].indexOf(prop)) val += 'px'\n        this.style[prop] = val\n        return this\n      } else {\n        var style = window.getComputedStyle(this)\n        return prop ? style[prop] : style\n      }\n    }\n\n    /* add a class */\n    addClass (classes) {\n      this.forEach( elem => {\n        elem.className += ` ${classes}`\n      })\n      return this    \n    }\n\n    /* remove a class */\n    removeClass (cnames) {\n      const splitCnames = cnames.split(' ')\n      splitCnames.forEach( cname => {\n        const matcher = ` ${cname}|${cname} |${cname}`\n        this.forEach( elem => {\n          elem.className = elem.className.replace(new RegExp(matcher, 'g'), '')        \n        })\n      })\n      return this\n    }\n\n    /* get classes */\n    getClass () {\n      return this.className\n    }\n\n    /* check for existence of class */\n    hasClass (className) {\n      const matcher = new RegExp(`(^| +)${className}($| )`)\n      return matcher.test(this.className)\n    }\n\n    /* if class exists, remove class, otherwise, add class */\n    toggleClass (cname) {\n      this.forEach( elem => {\n        if (RegExp(cname).test(elem.className)) {\n          l(elem).removeClass(cname)\n        } else {\n          l(elem).addClass(cname)\n        }\n      })\n      \n      return this\n    }\n\n    /* get the offset of an element relative to the window */\n    offset () {\n      return {\n        top: this.offsetTop,\n        left: this.offsetLeft,\n        right: this.offsetRight\n      }\n    }\n\n    /* get the height of an element */\n    height () {\n      return this.offsetHeight\n    }\n\n    /* get the inner height (content height) of an element */\n    innerHeight () {\n      return this.clientHeight\n    }\n\n    /* get the content height, including content not visible */\n    outerHeight () {\n      return this.scrollHeight\n    }\n\n    /* get the width of an element */\n    width () {\n      return this.offsetWidth\n    }\n\n    /* get the inner width (content width) of an element */\n    innerWidth () {\n      if (this.selector === 'window') return this.innerWidth\n      else return this.clientWidth\n    }\n\n    /* get the content width, including content not visible */    \n    outerWidth () {\n      return this.scrollWidth\n    }\n\n    show (flex) {\n      this.forEach( elem => {\n        const elemStyle = elem.style\n        elemStyle.display = flex ? 'flex' : 'block'\n        elemStyle.visibility = 'visible'\n      })\n      return this\n    }\n\n    hide (noreflow) {\n      this.forEach( elem => {\n        elem.style[noreflow ? 'visibility' : 'display'] = noreflow ? 'hidden' : 'none'\n      })\n      return this\n    }\n\n    toggle (show) {\n      return this[show ? 'show' : 'hide']()\n    }\n\n    append (child) {\n      this.forEach( elem => {\n        elem.appendChild(child)\n      })\n      return this\n    }\n\n    prepend (elem) {\n      this.insertBefore(elem, this.firstChild)\n      return this\n    }\n\n    appendTo (elem) {\n      L(elem).append(this)\n      return this\n    }\n\n    prependTo (elem) {\n      L(elem).prepend(this)\n      return this\n    }\n\n    html (html) {\n      this.empty()\n      this.forEach( elem => {\n        if (typeof html === 'string') elem.innerHTML = html\n        else elem.append(html)\n      })\n      return this    \n    }\n\n    empty () {\n      this.forEach( elem => {\n        let child\n        while (child = this.firstChild) {\n          this.removeChild(child)\n        }\n      })\n      return this\n    }\n    /*\n    remove (elem) {\n      elem = ( typeof elem === 'string' ? dom(elem) : elem ) || this\n      elem.parentNode && elem.parentNode.removeChild(elem)\n      return elem\n    },\n    replaceWith (elem) {\n      this.parentNode.replaceChild(elem || elem, this)\n      return dom(elem)\n    },\n    clone (deep) {\n      return this.cloneNode(deep)\n    },\n    next () {\n      return this.nextElementSibling\n    },\n    parent () {\n      return this.parentNode\n    },\n    */\n    child () {\n      return this.map( elem => {\n        return elem.firstChild \n      })\n    }\n    /*\n    previous () {\n      return this.previousElementSibling\n    },\n    isImg () {\n      return !!(this && this.nodeName === 'IMG')\n    }\n    */\n    on (eType, ...args) {\n      // Handle overloaded function without changing variable types\n      let target, handler, options\n      switch (args.length) {\n        case 1:\n          target = null\n          handler = args[0]\n          break\n        case 2:\n          if (typeof args[0] === 'string') {\n            target = args[0]\n            handler = args[1]\n          } else {\n            target = null\n            handler = args[0]\n            options = args[1]\n          }\n          break\n        case 3: \n            target = args[0]\n            handler = args[1]\n            options = args[2]\n            break\n        default:\n          throw new TypeError('\"on\" function signature is (event_type(String)[required], event_target(HTMLElement|String)[optional], handler(Function)[required], options(Object)[optional]')\n      }\n      return this._on(eType, target, handler, options)\n    }\n\n    _on (eType, target, handler, options = {}) {\n      function wrappedHandler (evt) {\n        if (!target) return handler.bind(this)(evt)\n        let iteration = evt.target\n        const targets = [...evt.currentTarget.querySelectorAll(target)]\n        while( iteration !== evt.currentTarget ) {\n          if (~targets.indexOf(iteration)) {\n            return handler.bind(iteration)(evt)\n          }\n          iteration = iteration.parentElement \n        } \n      }\n\n      function wrappedHandlerOnce (evt) {\n        wrappedHandler.call(this, evt)\n        l(this).off(eType, handler)\n      }\n\n      this.forEach( elem => {\n        Listener.register(new Listener(\n            elem\n          , eType\n          , handler\n          , options.once ? wrappedHandlerOnce : wrappedHandler\n          , target\n        ))        \n      })\n\n      return this \n    }\n\n    once () {\n      this.on.apply(this, [...arguments, { once: true }])\n    }\n\n    off (eType, handler) {\n      this.forEach( elem => {\n        Listener.deregister(new Listener(\n            elem\n          , eType\n          , handler\n       ))\n      })\n    }\n\n    deregisterEvents () {\n      Listener.deregisterDOMNode(this)\n      return this\n    }\n\n    trigger (eventName, detail) {\n      const nativeEvents = [\n        'mouseenter'\n      , 'mouseover'\n      , 'mousemove'\n      , 'mousedown'\n      , 'mouseup'\n      , 'click'\n      , 'dblclick'\n      , 'contextmenu'\n      , 'wheel'\n      , 'mouseleave'\n      , 'mouseout'\n      , 'select'\n      ]\n      if (~nativeEvents.indexOf(eventName)) {\n        this.forEach( elem => {\n          elem[eventName]()\n        })\n      } else {\n        let customEvent \n        try {\n          customEvent = new CustomEvent(eventName, detail)\n        } catch (e) {\n          // IE11\n          customEvent = document.createEvent('CustomEvent')\n          customEvent.initCustomEvent(eventName, true, true, detail)\n        }\n        this.forEach( elem => {\n          elem.dispatchEvent(customEvent)\n        })\n      }\n      return this\n    }\n\n    getListeners () {\n      return Listener.getListeners()\n    }\n  }\n\n  const l = (...args) => {\n    return new L(...args)\n  }\n\n  const \n    // utility for ajax\n    _openAndReturnReq = (method, url) => {\n      const req = new XMLHttpRequest()\n      req.open(method, url)\n      return req\n    }\n\n  /** STATICS **/\n  Object.assign(l, {\n\n    getListeners (...args) {\n      return Listener.getListeners(...args)\n    },\n\n    /* @ execute a callback for every key:value in an object */\n    each (obj, callback) {\n      for (let key in obj) {\n        if (obj.hasOwnProperty(key)) {\n          callback(key, obj[key], obj)\n        }\n      }\n    },\n\n    /* $.ready substitute */\n    DOMContentLoaded (_callback) {\n      if (document.readyState !== 'loading') return _callback()\n      const callback = () => {\n        _callback()\n        // cleanup\n        l(document).off('DOMContentLoaded', callback) \n      }\n      l(document).on('DOMContentLoaded', callback)\n    },\n\n    /** @ a manager for page routing based on location.hash\n      * - based on the target, will ajax an html file of the same name into the DOM.\n      *\n      * config: {\n      *   view: \"selector for the container where views are to be rendered\",\n      *   templateDirectory: \"the root directory containing HTML markup files\"\n      * }\n       *\n      * publishes event \"view.{target}\" where {target} is #/{target} or #{target}\n    **/\n    router (config = {}) {\n      const { view, templateDirectory, callbacks={} } = config\n      let initialized = false\n\n      l(window).on('hashchange', () => {\n        const hash = window.location.hash\n        // slice off the leading '#' and a following '/' if there is one\n        const route = hash.slice(hash[1]==='/'?2:1)\n        this.ajax({\n          url: `${templateDirectory}/${route}.html`\n        })\n        .then( req => {\n          l(view).html(req.response)\n          l(document).trigger('view.'+route)\n          ;(typeof callbacks[route] === 'function') && callbacks[route]()\n        })\n        .catch( err => {\n          throw err\n        })\n        initialized = true\n      })\n      window.location.hash && !initialized && l(window).trigger('hashchange')\n    },\n\n    /* @ creates and returns a Promise representing an HTTP response */\n    ajax ({ url = '', method = 'GET', data }) {\n      return new Promise( (resolve, reject) => {\n        const req = _openAndReturnReq(method, url)\n\n        req.onreadystatechange = () => {\n          if (req.readyState === 4) {\n            switch (Math.floor(req.status/100)) {\n              case 4:\n              case 5:\n                reject(req)\n                break\n              default:\n                resolve(req)\n            }\n          }\n        }\n        req.send(data)\n      })\n    },\n\n    /** @ creates a new DOM node or collection of DOM nodes\n      * - {elem} may be either the name of an element, such as \"span\", or it may be a more complex\n      *   string of markup, such as \"<span id='span1' class='sideways-baseball-cap'></span>\"\n    **/\n    create (elem) {\n      let newElement\n      if (elem[0] === '<') {\n        const temp = document.createElement('div')\n        temp.innerHTML = elem\n        newElement = ( temp.childElementCount === 1 ? temp.firstChild : temp.children )\n      } else {\n        newElement = document.createElement(elem)\n      }\n      return newElement\n    },\n\n    /** @ the wrapper for the web-app\n      * - {head} js to execute immediately\n      * - {body} js to be run onDOMContentLoaded\n    **/\n    init ({ head = noop, body = noop }) {\n      try {\n        head()\n        this.DOMContentLoaded(body)\n      } catch (e) {\n        if (~location.search.indexOf('mobile')) {\n          document.write('<h1>'+e.stack+'</h1>')\n        } else {\n          console.error(e)\n        }\n      }\n    },\n\n    /** @ serializes an object for inclusion as url parameters **/\n    params (obj) {\n      return Object.keys(obj).reduce( (prev, curr, i, arr) => {\n        return prev += `${curr}=${encodeURIComponent(obj[curr])}${i !== arr.length-1 ? '&' : ''}`\n      }, '?')\n    }\n  })\n\n  window.l = l\n\n  // non-obtrusive prototype methods\n  Object.prototype.forIn = (callback) => {\n    for (let key in this) {\n      if (this.hasOwnProperty(key)) {\n        callback(key, this[key], this)\n      }\n    } \n  }\n  // override\n  console.debug = (...args) => {\n    if (window.DEBUG) console.log(...args)\n  }\n})()\n"]}